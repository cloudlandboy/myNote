{"root":{"data":{"text":"XML 映射配置文件（三）","expandState":"expand"},"children":[{"data":{"text":"插件（plugins）","expandState":"collapse"},"children":[{"data":{"text":"MyBatis 允许你在已映射语句执行过程中的某一点进行拦截调用"},"children":[]},{"data":{"text":"允许使用插件来拦截的方法调用包括","expandState":"collapse"},"children":[{"data":{"text":"Executor (update, query, flushStatements, commit, rollback, getTransaction, close, isClosed)"},"children":[]},{"data":{"text":"ParameterHandler (getParameterObject, setParameters)"},"children":[]},{"data":{"text":"ResultSetHandler (handleResultSets, handleOutputParameters)"},"children":[]},{"data":{"text":"StatementHandler (prepare, parameterize, batch, update, query)"},"children":[]}]},{"data":{"text":"方法","expandState":"collapse"},"children":[{"data":{"text":"只需实现 Interceptor 接口，并指定了想要拦截的方法签名即可"},"children":[]},{"data":{"text":"例子","expandState":"expand"},"children":[{"data":{"text":"拦截在 Executor 实例中所有的 “update” 方法调用"},"children":[]},{"data":{"id":"bztn4wib2b40","created":1578814796159,"text":" ","image":"https://i.postimg.cc/HkbRkqss/20200112153916.png","imageTitle":"20200112153916.png","imageSize":{"width":200,"height":136}},"children":[]},{"data":{"text":"<!-- mybatis-config.xml -->\r\n<plugins>\r\n  <plugin interceptor=\"org.mybatis.example.ExamplePlugin\">\r\n    <property name=\"someProperty\" value=\"100\"/>\r\n  </plugin>\r\n</plugins>","background":"#c7edcc"},"children":[]}]}]}]},{"data":{"text":"databaseIdProvider","expandState":"collapse"},"children":[{"data":{"text":"可以根据不同的数据库厂商执行不同的语句，这种多厂商的支持是基于映射语句中的 databaseId 属性"},"children":[]},{"data":{"text":"MyBatis 会加载不带 databaseId 属性和带有匹配当前数据库 databaseId 属性的所有语句"},"children":[]},{"data":{"text":"<databaseIdProvider type=\"DB_VENDOR\" />"},"children":[]},{"data":{"text":"<databaseIdProvider type=\"DB_VENDOR\">\r\n  <property name=\"SQL Server\" value=\"sqlserver\"/>\r\n  <property name=\"DB2\" value=\"db2\"/>        \r\n  <property name=\"Oracle\" value=\"oracle\" />\r\n</databaseIdProvider>","background":"#c7edcc"},"children":[]}]},{"data":{"text":"映射器（mappers）","expandState":"collapse"},"children":[{"data":{"text":"概念","expandState":"collapse"},"children":[{"data":{"text":"用于引用定义好的映射定义，告诉mybatis去哪里找我们的sql定义配置"},"children":[]}]},{"data":{"text":"四种方式","expandState":"collapse"},"children":[{"data":{"text":"直接引用xml文件","priority":1,"expandState":"collapse"},"children":[{"data":{"text":"<mappers>  \r\n     <mapper resource=\"com/yu/res/UserMapper.xml\" />  \r\n</mappers>","background":"#c7edcc"},"children":[]}]},{"data":{"text":"通过绝对路径引用，注意在绝对路径前加上：“file:///”","priority":2,"expandState":"collapse"},"children":[{"data":{"text":"<mappers>  \n\t <mapper url=\"file:///D:/workspace/mywork/MyBatis/src/com/yu/res/UserMapper.xml\"/> \n</mappers>","background":"#c7edcc"},"children":[]}]},{"data":{"text":"引用mapper接口对象的方式","priority":3,"note":"此种方法要求mapper接口名称和mapper映射文件名称相同，且放在同一个目录中。","expandState":"collapse"},"children":[{"data":{"text":"<mappers>  \r\n     <mapper resource=\"com.yu.mapper.UserMapper\" />  \r\n</mappers>","background":"#c7edcc"},"children":[]}]},{"data":{"text":"引用mapper接口包的方式","priority":4,"note":"此种方法要求mapper接口和mapper映射文件要名称相同，且放到同一个目录下","expandState":"collapse"},"children":[{"data":{"text":"<mappers>  \r\n     <package name=\"com.yu.mapper\"/>\r\n</mappers>","background":"#c7edcc"},"children":[]}]}]}]},{"data":{"text":"配置环境（environments）","expandState":"collapse","hyperlink":"https://mybatis.org/mybatis-3/zh/configuration.html#environments","hyperlinkTitle":""},"children":[{"data":{"text":"概念","expandState":"collapse"},"children":[{"data":{"text":"配置成适应多种环境，这种机制有助于将 SQL 映射应用于多种数据库之中"},"children":[]},{"data":{"text":"不过要记住：尽管可以配置多个环境，每个 SqlSessionFactory 实例只能选择其一。"},"children":[]}]},{"data":{"text":"使用场景","expandState":"collapse"},"children":[{"data":{"text":"1）为了开发设置不同的数据库配置"},"children":[]},{"data":{"text":"2）测试和生产环境数据库不同"},"children":[]},{"data":{"text":"3）有多个数据库却共享相同的模式，即对不同的数据库使用相同的SQL映射"},"children":[]}]},{"data":{"text":"代码","expandState":"collapse"},"children":[{"data":{"id":"bztrzqv8wts0","created":1578828497609,"text":" ","image":"https://i.postimg.cc/rsS782Y5/20200112192742.png","imageTitle":"20200112192742.png","imageSize":{"width":200,"height":134}},"children":[]},{"data":{"text":"用default指定默认的数据库链接：：<environments default=\"oracle_jdbc\">"},"children":[]}]},{"data":{"text":"根据数据库环境，获取SqlSessionFactory","expandState":"collapse"},"children":[{"data":{"text":"SqlSessionFactory factory = sqlSessionFactoryBuilder.build(reader, environment);"},"children":[]},{"data":{"text":"SqlSessionFactory factory = sqlSessionFactoryBuilder.build(reader, environment,properties);"},"children":[]}]}]}]},"template":"default","theme":"fresh-blue","version":"1.4.43"}